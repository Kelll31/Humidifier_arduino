# Release v1.7.2 - Режимы отображения + Аналитика

## ✨ Новое в v1.7

### 💧 Датчик уровня воды
- **Автообнаружение** при старте
- **Автоостановка** при низком уровне
- **Индикация "W!"** на дисплее
- Защита от работы "всухую"
- Работа без датчика

### 🧊 Детектор открытого окна
- Программная логика (без доп.датчиков)
- Анализ падения температуры (2°C за 30с)
- **Автопауза** при проветривании
- **Индикация "O"** на дисплее

### 📊 Расширенная статистика
- **24 часа истории** в EEPROM
- Средняя температура и влажность
- Время работы и переключения
- **4 байта/час** - оптимизировано

### 🧠 Адаптивное обучение
- Автоподстройка уставок под помещение
- Анализ 24 часов
- Адаптация к сезону

### 📺 2 режима главного экрана (v1.7.2)

#### Режим 1: ДАННЫЕ
```
Т:23.5C
В:65.2%
Уст:60%
Статус: РАБОТАЕТ
Работа:2ч3м
```

#### Режим 2: ГРАФИК
```
┌────────────────────┐
│70│    ┌─┐        │
│  │   ┌┘  └─┐      │
│  │  ┌┘      └┐ ┌─┐│
│  │ ┌┘         └─┘  │
│60│─┘              ● │
└────────────────────┘
● = увлажнитель
```

**Переключение:** вращение энкодера на главном экране

## 🐛 Исправлено

### v1.7.2
- 🐛 Проблемы с отображением текста на главном экране
- 🐛 Нестабильное отображение меню
- 🐛 Переполнение экрана графиком и текстом

### v1.7.1
- 🐛 Исправлены координаты текста (setCursor вместо setCursorXY)

## 🎮 Управление

**На главном экране:**
- **Вращение энкодера** → переключение ДАННЫЕ ↔ ГРАФИК
- **Длинное нажатие (2с)** → вход в меню

**В меню:**
- **Вращение** → навигация/изменение
- **Короткое нажатие** → выбор
- **Длинное нажатие** → выход

## 💻 Технические детали

### Память
- RAM: ~760 байт свободно
- Flash: ~28KB
- EEPROM: 296/1024 байт

### Новые файлы
- `analytics.h` - модуль аналитики

### Обновленные файлы
- `config.h` - новые настройки
- `display.h` - 2 режима отображения
- `humidifier.h` - метод stop()
- `Humidifier_arduino.ino` - интеграция analytics

## 🔧 Подключение датчика воды

```
+5V ---[Sensor]--- A0
                   |
                 [10kΩ]
                   |
                  GND
```

**Калибровка WATER_THRESHOLD:**
1. Полный бак: 700-900
2. Пустой: 100-300
3. Установить: 300

---

**Автор:** kelll31  
**Дата:** 2026-02-12
